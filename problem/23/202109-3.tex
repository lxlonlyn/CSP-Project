% \section{202109-3 脉冲神经网络}

% \input{problem/23/202109-3-p.tex}

\subsection{\texorpdfstring{$70\%$}{70\%} 数据——模拟}

\subsubsection{思路}

先不考虑具体时间复杂度，思考朴素做法应该怎么做：

\begin{enumerate}
    \item 枚举 $[0,T]$ 每个时刻，这里应为一个外层循环；
    \item 对脉冲源进行处理：通过 $r$ 参数判断是否会发射脉冲；
    \item 对神经元进行处理：通过 $v_k$ 判断是否会发射脉冲；如果发射脉冲，则更新 $u_k,v_k$。
\end{enumerate}

判断脉冲源是否发射脉冲相对容易。但对于神经元来说，由于传播延迟的存在，我们需要知道 $I_k$，
即神经元在 $k$ 时刻接收到所有脉冲输入的强度之和。
又由于每个神经元是否发射脉冲是互相独立的，我们需要知道{\heiti{每个神经元}}在{\heiti{每个时刻}}接收到的脉冲和。

一种思路是开一个 $\mathrm{O}(NT)$ 的二维数组来记录。由于空间大小的限制，我们只能通过 $70\%$ 数据。

再来考虑时间复杂度：枚举时刻是 $\mathrm{O}(T)$，枚举脉冲、神经元及发射脉冲需要 $\mathrm{O}(N+S+P)$，
整体复杂度 $\mathrm{O}(T(N+S+P))$，可以通过所有的数据。

\subsection{\texorpdfstring{$100\%$}{100\%} 数据——滚动数组优化}

\subsubsection{思路}

为了得到满分，目前的任务是缩小记录每个神经元 $I_k$ 的空间复杂度。

\begin{note}
    题目给出的量的大小一般都是有用的。如果没有思路时，可以从这些貌似“没用”的量上进行突破，比如本题的 $D$。
\end{note}

考虑耗费空间的位置：虽然有传播延迟 $d$ 的存在，但在某个时刻 $t$，
能影响到神经元 $I_k$ 的时刻范围在 $[t, t+\max\{d\}]$ 范围内。
一方面，对于 $k>t+\max\{d\}$ 的 $I_k$ 我们没必要记录，因为不会有脉冲对其造成影响；
另一方面，对于 $k<t$ 的 $I_k$ 我们没必要保留。
我们只需要维护 $k\in [t, t+\max\{d\}]$ 的 $I_k$ 值就可以完成任务。
在这种情况下我们可以利用{\heiti{滚动数组}}进行优化。

\begin{definition}[滚动数组] \label{def:scroll array}
    \hspace{2em} 滚动数组是一种思想，通过对数组“取余”来缩小空间。设目前需要保留值的个数为 $p$，则在使用滚动数组后，原数组在 $i$ 的位置由 $i \bmod p$ 替代。

    \hspace{2em} 不妨设求解原数组中 $i$ 位置值涉及的位置有 $[i-p, i-1]$，
    当计算出原数组 $i$ 位置的值后，直接覆盖 $i \bmod p$ 位置的值即可。
    因为被覆盖的值为 $i-p$ 位置的值，在下次计算 $i+1$ 位置的值时，
    需要的区间为 $[i-p+1,i]$，已经不需要存储该位置的值了，所以可以放心覆盖。

    \hspace{2em} 在选取合适的 $p$ 的时候，可以尽量大一些，防止覆盖需要保留的数据。
\end{definition}

对于这道题，我们可以利用滚动数组的思路，将空间优化到 $\mathrm{O}(ND)$，即可通过此题。

\subsubsection{C++实现}

\lstinputlisting[language=c++]{code/23/202109-3-100.cpp}